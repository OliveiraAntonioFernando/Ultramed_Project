{% extends 'base.html' %}
{% block content %}
<div class="bg-gray-100 min-h-screen pb-20">
    <nav class="bg-marsala-700 p-8 rounded-b-[3rem] shadow-xl text-white mb-8">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <div>
                <h2 class="text-2xl font-black italic uppercase italic">Pacientes</h2>
                <p class="text-[10px] font-bold uppercase tracking-widest opacity-80">Gestão de Beneficiários</p>
            </div>
            <div class="flex gap-4">
                <button onclick="abrirModalPaciente()" class="bg-white text-marsala-700 px-6 py-3 rounded-2xl font-black uppercase italic text-xs shadow-lg hover:bg-gray-100 transition-all flex items-center gap-2">
                    <i class="fas fa-plus"></i> Novo Paciente
                </button>
                <a href="{% url 'sistema_interno:painel_colaborador' %}" class="bg-white/20 px-6 py-3 rounded-2xl hover:bg-white/30 transition-all text-xs font-bold uppercase italic flex items-center">
                    Voltar
                </a>
            </div>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto px-4">
        <div class="bg-white rounded-[3rem] shadow-sm border border-gray-100 overflow-hidden">
            <div class="overflow-x-auto">
                <table class="w-full text-left border-collapse">
                    <thead>
                        <tr class="bg-gray-50">
                            <th class="p-6 text-[10px] font-black uppercase text-gray-400">Nome Completo</th>
                            <th class="p-6 text-[10px] font-black uppercase text-gray-400">CPF</th>
                            <th class="p-6 text-[10px] font-black uppercase text-gray-400">Plano / Tipo</th>
                            <th class="p-6 text-[10px] font-black uppercase text-gray-400 text-right">Ações</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-50">
                        {% for p in pacientes %}
                        <tr class="hover:bg-gray-50 transition-colors">
                            <td class="p-6 text-xs font-black uppercase text-gray-800 italic">{{ p.nome_completo }}</td>
                            <td class="p-6 text-xs text-gray-500">{{ p.cpf }}</td>
                            <td class="p-6">
                                {% if p.plano %}
                                    <span class="text-[9px] font-black uppercase bg-emerald-100 text-emerald-700 px-3 py-1 rounded-full italic">{{ p.plano.nome }}</span>
                                {% else %}
                                    <span class="text-[9px] font-black uppercase bg-gray-100 text-gray-500 px-3 py-1 rounded-full italic">Particular</span>
                                {% endif %}
                            </td>
                            <td class="p-6 text-right space-x-2">
                                <a href="#" class="text-marsala-700 text-xs font-black uppercase italic mr-2">Editar</a>
                                {% if request.user.username == 'medico' or request.user.username == 'master' %}
                                <a href="{% url 'sistema_interno:prontuario_view' p.id %}" class="bg-marsala-700 text-white px-4 py-2 rounded-xl text-[10px] font-black uppercase italic hover:bg-marsala-800">
                                    Prontuário
                                </a>
                                {% endif %}
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="4" class="p-20 text-center text-gray-400 uppercase italic text-xs font-bold">Nenhum paciente cadastrado.</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </main>
</div>

<div id="modal-paciente" class="fixed inset-0 bg-gray-900/80 backdrop-blur-sm z-50 flex items-center justify-center hidden px-4">
    <div class="bg-white w-full max-w-lg rounded-[3rem] shadow-2xl overflow-hidden">
        <div class="bg-marsala-700 p-8 text-white flex justify-between items-center">
            <h3 class="font-black uppercase italic text-lg text-white">Novo Paciente</h3>
            <button onclick="fecharModalPaciente()" class="text-white/50 hover:text-white"><i class="fas fa-times fa-lg"></i></button>
        </div>
        <form method="POST" action="{% url 'sistema_interno:cliente_create' %}" class="p-8 space-y-4">
            {% csrf_token %}
            <div>
                <label class="text-[10px] font-black uppercase text-gray-400 tracking-widest">Nome Completo</label>
                <input type="text" name="nome_completo" required class="w-full border-b-2 py-2 outline-none focus:border-marsala-700 text-sm uppercase italic font-bold">
            </div>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="text-[10px] font-black uppercase text-gray-400 tracking-widest">CPF</label>
                    <input type="text" name="cpf" required placeholder="000.000.000-00" class="w-full border-b-2 py-2 outline-none focus:border-marsala-700 text-sm">
                </div>
                <div>
                    <label class="text-[10px] font-black uppercase text-gray-400 tracking-widest">Telefone</label>
                    <input type="text" name="telefone" required placeholder="(94) 9 0000-0000" class="w-full border-b-2 py-2 outline-none focus:border-marsala-700 text-sm">
                </div>
            </div>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="text-[10px] font-black uppercase text-gray-400 tracking-widest">Data Nascimento</label>
                    <input type="date" name="data_nascimento" required class="w-full border-b-2 py-2 outline-none focus:border-marsala-700 text-sm">
                </div>
                <div>
                    <label class="text-[10px] font-black uppercase text-gray-400 tracking-widest">Sexo</label>
                    <select name="sexo" class="w-full border-b-2 py-2 outline-none focus:border-marsala-700 text-sm bg-transparent">
                        <option value="M">Masculino</option>
                        <option value="F">Feminino</option>
                    </select>
                </div>
            </div>
            <button type="submit" class="w-full bg-marsala-700 text-white font-black py-4 rounded-2xl uppercase italic shadow-xl hover:bg-marsala-800 transition-all mt-4">
                Salvar Cadastro
            </button>
        </form>
    </div>
</div>

<script>
    function abrirModalPaciente() {
        document.getElementById('modal-paciente').classList.remove('hidden');
    }
    function fecharModalPaciente() {
        document.getElementById('modal-paciente').classList.add('hidden');
    }
</script>
{% endblock %}
